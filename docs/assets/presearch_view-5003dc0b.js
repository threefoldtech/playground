import{d as H,u as x,r as o,a as F,b as s,o as k,c as $,w as l,g as j,e as g,f as t,m as E,h as S,i as q,j as C,k as z,n as Y,_ as O,l as G,F as M}from"./index-df6f743d.js";import{r as Q,_ as K,P as B,d as J,a as W}from"./tf_deployment_list.vue_vue_type_script_setup_true_lang-1803a4f6.js";import"./list_table.vue_vue_type_script_setup_true_lang-046c7938.js";const X=C("a",{class:"app-link",href:"https://manual.grid.tf/weblets/weblets_presearch.html",target:"_blank"}," Quick start documentation ",-1),Z={name:"TFPresearch",components:{SelectFarm:K}},ee=H({...Z,setup(N){const r=x(),_=o(),m=F(),u=o("PS"+j(8)),d=o(""),i=o(!1),p=o(!0),f=4,P=8192,U=Q(f,P),c=o(),y=o(""),h=o("");async function A(){r.value.setStatus("deploy");const n=B.Presearch.toLowerCase();try{const e=await z(m.profile,n);await r.value.validateBalance(e);const v=await J(e,{name:u.value,machines:[{name:u.value,cpu:f,memory:P,flist:"https://hub.grid.tf/tf-official-apps/presearch-v2.2.flist",entryPoint:"/sbin/zinit init",farmId:c.value.farmID,farmName:c.value.name,planetary:p.value,publicIpv4:i.value,country:c.value.country,envs:[{key:"SSH_KEY",value:m.profile.ssh},{key:"PRESEARCH_REGISTRATION_CODE",value:d.value},{key:"PRESEARCH_BACKUP_PRI_KEY",value:y.value},{key:"PRESEARCH_BACKUP_PUB_KEY",value:h.value}]}]});r.value.reloadDeploymentsList(),r.value.setStatus("success","Successfully deployed a Presearch instance."),r.value.openDialog(v,{SSH_KEY:"Public SSH Key",PRESEARCH_REGISTRATION_CODE:"Presearch Registration Code",PRESEARCH_BACKUP_PRI_KEY:"Presearch Backup Private Key",PRESEARCH_BACKUP_PUB_KEY:"Presearch Backup Public Key"})}catch(e){r.value.setStatus("failed",Y(e,"Failed to deploy a Presearch instance."))}}return(n,e)=>{const v=s("v-text-field"),R=s("input-validator"),I=s("password-input-wrapper"),V=s("v-switch"),w=s("v-textarea"),D=s("d-tabs"),L=s("v-btn"),T=s("weblet-layout");return k(),$(T,{ref_key:"layout",ref:r},{title:l(()=>[g("Deploy a Presearch Instance")]),subtitle:l(()=>[g("Presearch is a community-powered, decentralized search engine that provides better results while protecting your privacy and rewarding you when you search. This weblet deploys a Presearch node. Presearch Nodes are used to process user search requests, and node operators earn Presearch PRE tokens for joining and supporting the network. "),X]),"footer-actions":l(()=>{var a;return[t(L,{color:"primary",variant:"tonal",disabled:(a=_.value)==null?void 0:a.invalid,onClick:A},{default:l(()=>[g(" Deploy ")]),_:1},8,["disabled"])]}),default:l(()=>[t(D,{tabs:[{title:"Base",value:"base"},{title:"Restore",value:"restore"}],ref_key:"tabs",ref:_},{base:l(()=>[t(R,{value:u.value,rules:[n.validators.required("Name is required."),n.validators.minLength("Name minLength is 2 chars.",2),n.validators.maxLength("Name maxLength is 15 chars.",15)]},{default:l(({props:a})=>[t(v,E({label:"Name",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=b=>u.value=b)},a),null,16,["modelValue"])]),_:1},8,["value","rules"]),t(R,{value:d.value,rules:[n.validators.required("Presearch registration code is required."),n.validators.equal("Presearch registration code must be 32 characters long.",32)]},{default:l(({props:a})=>[t(I,null,{default:l(()=>[t(v,E({label:"Presearch Registeration Code"},a,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=b=>d.value=b)}),null,16,["modelValue"])]),_:2},1024)]),_:1},8,["value","rules"]),t(V,{color:"primary",inset:"",label:"Public IPv4",modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=a=>i.value=a)},null,8,["modelValue"]),t(V,{color:"primary",inset:"",label:"Planetary Network",modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value=a)},null,8,["modelValue"]),t(K,{filters:{cpu:f,memory:P,ssd:S(U),publicIp:i.value},modelValue:S(c),"onUpdate:modelValue":e[4]||(e[4]=a=>q(c)?c.value=a:null)},null,8,["filters","modelValue"])]),restore:l(()=>[t(w,{label:"Private Presearch Restore Key",modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=a=>y.value=a),"no-resize":"",spellcheck:!1},null,8,["modelValue"]),t(w,{label:"Public Presearch Restore Key",modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=a=>h.value=a),"no-resize":"",spellcheck:!1},null,8,["modelValue"])]),_:1},512)]),_:1},512)}}}),ae={name:"PresearchView",components:{Presearch:ee,TfDeploymentList:W},setup(){return{name:B.Presearch}}},te={class:"mt-4"};function le(N,r,_,m,u,d){const i=s("Presearch"),p=s("TfDeploymentList");return k(),G(M,null,[t(i),C("div",te,[t(p,{"project-name":m.name},null,8,["project-name"])])],64)}const ne=O(ae,[["render",le]]);export{ne as default};
